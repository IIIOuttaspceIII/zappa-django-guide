



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A full featured walkthough of using Django on Zappa (powered by AWS Lambda in serverless environment)">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Adventures in Networking - Guide to using Django with Zappa</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#adventures-in-networking" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Guide to using Django with Zappa" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Guide to using Django with Zappa
              </span>
              <span class="md-header-nav__topic">
                Adventures in Networking
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/edgarroman/zappa-django-guide/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      edgarroman/zappa-django-guide
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Guide to using Django with Zappa
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/edgarroman/zappa-django-guide/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      edgarroman/zappa-django-guide
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Walkthroughs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Walkthroughs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../setup/" title="Setup your Environment" class="md-nav__link">
      Setup your Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../walk_core/" title="Core Django Setup" class="md-nav__link">
      Core Django Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../walk_static/" title="Hosting Static Files" class="md-nav__link">
      Hosting Static Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../walk_database/" title="Using a Database" class="md-nav__link">
      Using a Database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../walk_domain/" title="Custom Domains" class="md-nav__link">
      Custom Domains
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../walk_app/" title="Application Adaptations" class="md-nav__link">
      Application Adaptations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      AWS Setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        AWS Setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../aws_credentials/" title="Managing Credentials" class="md-nav__link">
      Managing Credentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aws_network_primer/" title="Primer on AWS VPC Networking" class="md-nav__link">
      Primer on AWS VPC Networking
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Adventures in Networking
      </label>
    
    <a href="./" title="Adventures in Networking" class="md-nav__link md-nav__link--active">
      Adventures in Networking
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-simple-but-naive-approach" title="A simple, but naive approach" class="md-nav__link">
    A simple, but naive approach
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thats-why-amazon-has-vpc" title="That's why Amazon has VPC" class="md-nav__link">
    That's why Amazon has VPC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-essential-vpc-and-subnet-configuration" title="The Essential VPC and Subnet Configuration" class="md-nav__link">
    The Essential VPC and Subnet Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-vpc" title="Extending the VPC" class="md-nav__link">
    Extending the VPC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vpc-patterns" title="VPC Patterns" class="md-nav__link">
    VPC Patterns
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vpc-with-a-single-internet-accessible-subnet" title="VPC with a single Internet-Accessible subnet" class="md-nav__link">
    VPC with a single Internet-Accessible subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpc-with-a-public-subnet-and-private-subnet" title="VPC with a Public subnet and Private subnet" class="md-nav__link">
    VPC with a Public subnet and Private subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-premises-and-internet-accessible-vpc" title="On-Premises and Internet-Accessible VPC" class="md-nav__link">
    On-Premises and Internet-Accessible VPC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpc-with-an-internal-only-subnet" title="VPC with an Internal-Only subnet" class="md-nav__link">
    VPC with an Internal-Only subnet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subdividing-the-vpc" title="Subdividing the VPC" class="md-nav__link">
    Subdividing the VPC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples-for-walkthroughs" title="Examples for Walkthroughs" class="md-nav__link">
    Examples for Walkthroughs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#note-on-redundancy" title="Note on Redundancy" class="md-nav__link">
    Note on Redundancy
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aws_database/" title="Creating an RDS Database" class="md-nav__link">
      Creating an RDS Database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aws_route53/" title="Working with Route53" class="md-nav__link">
      Working with Route53
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aws_acm/" title="AWS Certificate Manager (ACM)" class="md-nav__link">
      AWS Certificate Manager (ACM)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../additional/" title="Additional" class="md-nav__link">
      Additional
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-simple-but-naive-approach" title="A simple, but naive approach" class="md-nav__link">
    A simple, but naive approach
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thats-why-amazon-has-vpc" title="That's why Amazon has VPC" class="md-nav__link">
    That's why Amazon has VPC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-essential-vpc-and-subnet-configuration" title="The Essential VPC and Subnet Configuration" class="md-nav__link">
    The Essential VPC and Subnet Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-vpc" title="Extending the VPC" class="md-nav__link">
    Extending the VPC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vpc-patterns" title="VPC Patterns" class="md-nav__link">
    VPC Patterns
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vpc-with-a-single-internet-accessible-subnet" title="VPC with a single Internet-Accessible subnet" class="md-nav__link">
    VPC with a single Internet-Accessible subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpc-with-a-public-subnet-and-private-subnet" title="VPC with a Public subnet and Private subnet" class="md-nav__link">
    VPC with a Public subnet and Private subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-premises-and-internet-accessible-vpc" title="On-Premises and Internet-Accessible VPC" class="md-nav__link">
    On-Premises and Internet-Accessible VPC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpc-with-an-internal-only-subnet" title="VPC with an Internal-Only subnet" class="md-nav__link">
    VPC with an Internal-Only subnet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subdividing-the-vpc" title="Subdividing the VPC" class="md-nav__link">
    Subdividing the VPC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples-for-walkthroughs" title="Examples for Walkthroughs" class="md-nav__link">
    Examples for Walkthroughs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#note-on-redundancy" title="Note on Redundancy" class="md-nav__link">
    Note on Redundancy
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/edgarroman/zappa-django-guide/edit/master/docs/aws_network.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="adventures-in-networking">Adventures in Networking<a class="headerlink" href="#adventures-in-networking" title="Permanent link">&para;</a></h1>
<p>Presumably, since you've read this far, you're interested in more than a simple Django powered API serving static images.  You probably want something that is more interactive with users and have advanced capabilities.  So this will require interacting with additional AWS services like RDS or DynamoDB for database services, SNS or SQS for task processing, and many more...</p>
<p>Well, there is an important aspect about interacting with additional AWS services.  With pure AWS lambda, we have a fairly low attack surface, but when we introduce additional interactions over the network, we must consider information security risks and our network architecture.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section assumes some familarity with the basic concepts within AWS VPC.  If you aren't comfortable with these concepts,
then head over to a <a href="../aws_network_primer/">Primer on AWS VPC Networking</a></p>
</div>
<h2 id="a-simple-but-naive-approach">A simple, but naive approach<a class="headerlink" href="#a-simple-but-naive-approach" title="Permanent link">&para;</a></h2>
<p>A simple approach would be to create an AWS RDS instance that is open to the Internet and have your lambda Django project login directly.  While this may work, this approach is fraught with peril.  Numerous vulnerabilities could exist and credentials could be discovered by brute force.  Even without gaining access to your RDS, it is trivial to launch a denial-of-service attack to ensure your Django project has no database services.</p>
<p>Basically, do not do this.</p>
<h2 id="thats-why-amazon-has-vpc">That's why Amazon has VPC<a class="headerlink" href="#thats-why-amazon-has-vpc" title="Permanent link">&para;</a></h2>
<p>Introducing AWS Virtual Private Cloud (VPC).  This service provides a way of segmenting Internet traffic from your other AWS services.  This feature is incredibly valuable to securing our project, so that bad guys have the smallest attack surface possible.  </p>
<p>Once a VPC is established, you can then subdivide the VPC into subnets.  Which are little non-overlapping IP chunks of the overall VPC.  Like dividing a pie into slices.</p>
<p>It is important to realize that you have almost entire control of your IP space when you define your VPC and associated subnets.  You are creating a Software Defined Network (SDN) and you have a lot of leeway.  With this freedom comes choices and important considerations on how you design your network.</p>
<h2 id="the-essential-vpc-and-subnet-configuration">The Essential VPC and Subnet Configuration<a class="headerlink" href="#the-essential-vpc-and-subnet-configuration" title="Permanent link">&para;</a></h2>
<p>Here is the absolute minimum you must have to have a working Django site within a VPC:</p>
<ul>
<li>A VPC</li>
<li>A subnet within the VPC</li>
<li>A security group</li>
<li>Your zappa project configured to use the subnet and security group</li>
</ul>
<p>There are no need for routes, NAT gateways, Internet gateways, or even allowing inbound rules on the security group.  You will probably need many of these services eventually for a robust and full-featured application, but for illustration purposes now, we will keep it simple.</p>
<p>You may be asking yourself how will traffic from the Internet reach the lambda function. Well essentially the magic is in the API Gateway that zappa creates on deployment.  From the <a href="https://aws.amazon.com/api-gateway/faqs/">API Gateway FAQ</a>:</p>
<blockquote>
<p>Amazon API Gateway endpoints are always public to the Internet. Proxy requests to backend operations also need to be publicly accessible on the Internet. However, you can generate a client-side SSL certificate in Amazon API Gateway to verify that requests to your backend systems were sent by API Gateway using the public key of the certificate.</p>
</blockquote>
<p>So API Gateways act as an 'always-on' Internet facing service that sends the HTTP requests to the Zappa Lambda functions by creating 
Lambda events.  These events can reach your zappa application even if deployed in a top-secret lockbox.  Note that in the above VPC setup the Lambda function is completely isolated from direct access to the Internet.  Thus the Lambda functions can't make outbound connections to anything: other servers, databases, S3, etc.</p>
<p>Let's face it, there's no real point to going through the effort of doing this if the Lambda functions are really this isolated.<br />
<em>But</em> the reason this information is important is because in order to leverage other AWS resources, 
the VPC lays the foundation to do this securely.</p>
<h2 id="extending-the-vpc">Extending the VPC<a class="headerlink" href="#extending-the-vpc" title="Permanent link">&para;</a></h2>
<p>To re-iterate: we don't need a VPC network to make the Zappa Lambda-powered Django site visible on the Internet.<br />
We need to extend the VPC so that we can add more AWS services like:</p>
<ul>
<li>Adding an RDS database that is only accessible from our Lambda functions</li>
<li>Adding an S3 bucket </li>
<li>Allowing Lambda functions to communicate to traditional EC2 instances for long running processes</li>
<li>Allowing the Lambda functions to access the Internet to hit an external API</li>
<li>Ability to interact with SQS and/or SNS</li>
</ul>
<p>The important thing is that we can enable all these scenarios in a secure manner.  There are too many scenarios to go into detail here, so we will provide some guidelines.</p>
<p>Next we learn about the common patterns of VPC usage and try to identify usage options.</p>
<p>One warning before we go on with VPC subnet sizing and Lambda:  When Lambda functions fire, they must be assigned an IP address temporarily.  If you have a lot of Lambda functions firing, then you must have a lot of IP addresses available in your subnet.  You can learn more <a href="http://docs.aws.amazon.com/lambda/latest/dg/vpc.html#vpc-setup-guidelines">here</a>.</p>
<h2 id="vpc-patterns">VPC Patterns<a class="headerlink" href="#vpc-patterns" title="Permanent link">&para;</a></h2>
<p>While the actual VPC itself is very straightforward, the combination of subnets within the VPC can take many forms.  Additionally, you must consider how the subnets will communicate among themselves as well as how  they communicate with outside networks. For a more comprehensive list of options and other valuable information about VPCs, see this link: <a href="https://aws.amazon.com/answers/networking/aws-single-vpc-design/">https://aws.amazon.com/answers/networking/aws-single-vpc-design/</a></p>
<p>The options are summarized here:</p>
<h3 id="vpc-with-a-single-internet-accessible-subnet">VPC with a single Internet-Accessible subnet<a class="headerlink" href="#vpc-with-a-single-internet-accessible-subnet" title="Permanent link">&para;</a></h3>
<p>This pattern places your lambda functions, your RDS, and additional SNS/SQS services in a single subnet that is Internet accessible in your VPC.  In theory you could configure your security groups to ensure only lambda functions can hit your RDS.</p>
<p>One advantage of this setup is that you can setup your local machine to connect to your RDS without a <a href="http://serverfault.com/a/648116/60094">bastion host</a>.  Just restrict access based on IP.  </p>
<p>Important note - you will want to ensure careful inbound IP restrictions.  While it's great that you can connect to RDS with your SQL desktop client, you should setup a <a href="../(http://serverfault.com/a/648116/60094)">bastion host</a>.</p>
<p>Also note that your zappa deployment 
<a href="../aws_network_primer/#general-behavior-and-internet-access">will not have outbound access to the Internet</a>.
In order to do this you will have use a Public/Private setup.</p>
<div class="admonition quote">
<p class="admonition-title">Some additional considerations from the <a href="http://docs.aws.amazon.com/lambda/latest/dg/vpc.html#vpc-configuring">AWS Documentation</a></p>
<ul>
<li>
<p>We recommend that you avoid DNS resolution of public host names for your VPC. This can take several seconds to resolve, which adds several seconds of billable time on your request. For example, if your Lambda function accesses an Amazon RDS instance in your VPC, launch the instance with the no-publicly-accessible option.</p>
</li>
<li>
<p>When you add VPC configuration to a Lambda function, it can only access resources in that VPC. If a Lambda function needs to access both VPC resources and the public Internet, the VPC needs to have a Network Address Translation (NAT) instance inside the VPC.</p>
</li>
<li>
<p>When a Lambda function is configured to run within a VPC, it incurs an additional ENI start-up penalty. This means address resolution may be delayed when trying to connect to network resources.</p>
</li>
</ul>
</div>
<p><strong>This scenario is good for straightforward setups with a little work, but has significant limitations</strong></p>
<h3 id="vpc-with-a-public-subnet-and-private-subnet">VPC with a Public subnet and Private subnet<a class="headerlink" href="#vpc-with-a-public-subnet-and-private-subnet" title="Permanent link">&para;</a></h3>
<p>Arguably the most flexible and future-proof of all web application setups.  You have two subnets: one public and one private.  Your RDS and lambda functions reside in the private subnet, far away from bad guys, but also far away from your local machine.  In order to access the database from your system you will need a <a href="http://serverfault.com/a/648116/60094">bastion host</a> in the public subnet.  </p>
<p>Another advantage of this setup is that if you ever want to add additional EC2-based services that need to interact with the Internet you can do this very easily without compromising security.  </p>
<p>Generally this setup will require networking knowledge to setup the Internet gateway, bastion host, and NAT Gateway.</p>
<p><strong>The upshot is this configuration is the most secure and most flexible for your growth but will be complex from a network standpoint</strong></p>
<h3 id="on-premises-and-internet-accessible-vpc">On-Premises and Internet-Accessible VPC<a class="headerlink" href="#on-premises-and-internet-accessible-vpc" title="Permanent link">&para;</a></h3>
<p>Same as the last configuration, but if you have an internal corporate network to connect, you can easily establish a connection to the private subnet without compromising security.</p>
<p>If you thought the last setup was complex, you better know what you are doing from a network standpoint.</p>
<p><strong>A good solution if you need to connect an internal corporate network</strong></p>
<h3 id="vpc-with-an-internal-only-subnet">VPC with an Internal-Only subnet<a class="headerlink" href="#vpc-with-an-internal-only-subnet" title="Permanent link">&para;</a></h3>
<p>Obviously a very special case of creating a Django app for internal use only with no desire to have it accessible by the Internet.</p>
<p>This is actually most secure.  Since you can access any of the resources from your desktop on the internal network.  Not bad for the paranoid or security conscious devops team.</p>
<p><strong>Useful for the simple environment if you have an existing secure network</strong></p>
<h2 id="subdividing-the-vpc">Subdividing the VPC<a class="headerlink" href="#subdividing-the-vpc" title="Permanent link">&para;</a></h2>
<p>Once you get a VPC selected you must create subnets within the VPC.  When defining a subnet, you just have to pick a non-overlapping segment of the ip range.  So if you have VPC that spans IP address 10.5.0.1 to 10.5.0.254, then you pick contiguous segments within this range.</p>
<p>See more details in <a href="../aws_network_primer/">Primer on AWS VPC Networking</a></p>
<h2 id="examples-for-walkthroughs">Examples for Walkthroughs<a class="headerlink" href="#examples-for-walkthroughs" title="Permanent link">&para;</a></h2>
<p>For the purposes of walkthroughs, we will leverage a simple VPC with a single subnet.  A single subnet will generally be enough to guide readers through the scenarios.</p>
<p>We have a VPC:</p>
<ul>
<li>id: vpc-9a9a1dfc</li>
<li>cidr: 10.6.0.0/16</li>
</ul>
<p>With subnet:</p>
<ul>
<li>id: subnet-f3446aba</li>
<li>cidr: 10.6.1.0/24</li>
</ul>
<p>And security group:</p>
<ul>
<li>id: sg-13a5736f</li>
<li>inbound rules: none</li>
<li>outbound rules: all traffic</li>
</ul>
<blockquote>
<p>TODO: Show example zappa configuration here</p>
</blockquote>
<h2 id="note-on-redundancy">Note on Redundancy<a class="headerlink" href="#note-on-redundancy" title="Permanent link">&para;</a></h2>
<p>While these examples are all using a single subnet for clarity, in production you will want to create multiple subnets within the VPC all with different availability zones.  This ensures if there is a failure within a single availability zone, there are alternate paths.  </p>
<p>The general approach is to associate the Lambda functions with multiple subnets and the AWS resources with the same multiple subnets (e.g. RDS).</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../aws_network_primer/" title="Primer on AWS VPC Networking" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Primer on AWS VPC Networking
              </span>
            </div>
          </a>
        
        
          <a href="../aws_database/" title="Creating an RDS Database" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Creating an RDS Database
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2017 <a href="https://github.com/edgarroman">Edgar Roman</a>
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/edgarroman" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-97437653-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>